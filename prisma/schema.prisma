// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Users {
  Id             Int      @id @default(autoincrement())
  Email          String   @db.VarChar(100) @unique
  Name           String?  @db.VarChar(100)
  Role           Role     @default(USER)
  CreatedAt      DateTime @default(now())
  Password       String   @db.VarChar(255)
  BrandsByAdmins Brands[]
  PurchasedItems Purchases[]
}


model Purchases {
    Id        Int           @id @default(autoincrement())
    Product   Products      @relation(fields: [ProductId], references: [Id])
    ProductId Int
    User      Users         @relation(fields: [UserId], references: [Id])
    UserId    Int
    Stage     PurchaseStage @default(CART)
}


model Products {
    Id          Int      @id @default(autoincrement())
    Brand       Brands   @relation(fields: [BrandName], references: [Name])
    BrandName   String
    Name        String   @db.VarChar(200)
    Description String   @db.VarChar(1000)
    Info        Json     @db.Json()
    Remaining   Int
    CreatedAt   DateTime @default(now())
    Purchases   Purchases[]
}

model Brands {
  Name         String   @id @db.VarChar(50)
  BrandDetails String   @db.VarChar(255)
  CreatedAt    DateTime @default(now())
  Admin        Users    @relation(fields: [CreatedBy], references: [Id])
  CreatedBy    Int
  Products     Products[]
}

enum Role {
  SUPER_ADMIN
  ADMIN
  USER
}

enum PurchaseStage {
  CART
  PURCHASED
}